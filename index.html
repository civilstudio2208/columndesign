<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Column Design Calculator (IS Code)</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f5f7fa;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 10px;
        }
        
        .design-section {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .input-section, .output-section {
            flex: 1;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary);
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
        }
        
        .results {
            background-color: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .result-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ccc;
        }
        
        .result-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .result-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .result-value {
            font-size: 18px;
            color: var(--accent);
            font-weight: 700;
        }
        
        .code-section {
            margin-top: 30px;
        }
        
        .visualization {
            margin-top: 30px;
            text-align: center;
        }
        
        .column-diagram {
            width: 300px;
            height: 300px;
            border: 2px solid var(--dark);
            display: inline-block;
            position: relative;
            background-color: #f0f0f0;
            margin: 0 auto;
        }
        
        .reinforcement {
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: var(--accent);
            transform: translate(-50%, -50%);
            border: 2px solid #fff;
        }
        
        .ties {
            position: absolute;
            border: 2px solid var(--secondary);
            border-radius: 3px;
        }
        
        .cover {
            position: absolute;
            border: 1px dashed #999;
        }
        
        @media (max-width: 768px) {
            .design-section {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Column Design Calculator (IS 456 & IS 13920)</h1>
        
        <div class="design-section">
            <div class="input-section">
                <div class="input-group">
                    <label for="width">Column Width (mm)</label>
                    <input type="number" id="width" value="300" min="300" step="25">
                </div>
                
                <div class="input-group">
                    <label for="depth">Column Depth (mm)</label>
                    <input type="number" id="depth" value="300" min="300" step="25">
                </div>
                
                <div class="input-group">
                    <label for="axialLoad">Axial Load (kN)</label>
                    <input type="number" id="axialLoad" value="850" min="100" step="50">
                </div>
                
                <div class="input-group">
                    <label for="momentX">Moment about X-axis (kN·m)</label>
                    <input type="number" id="momentX" value="15" min="0" step="5">
                </div>
                
                <div class="input-group">
                    <label for="momentY">Moment about Y-axis (kN·m)</label>
                    <input type="number" id="momentY" value="32" min="0" step="5">
                </div>
                
                <div class="input-group">
                    <label for="concreteGrade">Concrete Grade</label>
                    <select id="concreteGrade">
                        <option value="20">M20</option>
                        <option value="25" selected>M25</option>
                        <option value="30">M30</option>
                        <option value="35">M35</option>
                        <option value="40">M40</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="steelGrade">Steel Grade</label>
                    <select id="steelGrade">
                        <option value="415">Fe 415</option>
                        <option value="500" selected>Fe 500</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="ductility">Ductility Requirement</label>
                    <select id="ductility">
                        <option value="normal">Normal (IS 456)</option>
                        <option value="special" selected>Special (IS 13920)</option>
                    </select>
                </div>
            </div>
            
            <div class="output-section">
                <h3>Design Results</h3>
                <div class="results" id="results">
                    <div class="result-item">
                        <div class="result-title">Status</div>
                        <div class="result-value" id="status">Enter values to calculate</div>
                    </div>
                    <div class="result-item">
                        <div class="result-title">Required Steel Area</div>
                        <div class="result-value" id="steelArea">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-title">Reinforcement Details</div>
                        <div class="result-value" id="reinforcement">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-title">Tie Details (IS 13920)</div>
                        <div class="result-value" id="tieDetails">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-title">Interaction Ratio</div>
                        <div class="result-value" id="interactionRatio">-</div>
                    </div>
                </div>
                
                <div class="visualization">
                    <h3>Column Cross-Section (40mm cover as per IS 456)</h3>
                    <div class="column-diagram" id="columnDiagram">
                        <!-- Reinforcement bars and ties will be added here dynamically -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants as per IS Codes
        const COVER = 40; // mm as per IS 456 for columns
        const MIN_BAR_DIA = 12; // mm minimum bar diameter
        const MAX_BAR_DIA = 32; // mm maximum bar diameter
        const MIN_BARS = 4; // Minimum number of bars as per IS 456
        
        // Get all input elements
        const inputs = document.querySelectorAll('input, select');
        
        // Add event listeners to all inputs for real-time calculation
        inputs.forEach(input => {
            input.addEventListener('input', calculateDesign);
        });
        
        // Initial calculation
        calculateDesign();
        
        function calculateDesign() {
            // Get input values
            const width = parseFloat(document.getElementById('width').value);
            const depth = parseFloat(document.getElementById('depth').value);
            const axialLoad = parseFloat(document.getElementById('axialLoad').value);
            const momentX = parseFloat(document.getElementById('momentX').value);
            const momentY = parseFloat(document.getElementById('momentY').value);
            const fck = parseFloat(document.getElementById('concreteGrade').value);
            const fy = parseFloat(document.getElementById('steelGrade').value);
            const isDuctile = document.getElementById('ductility').value === 'special';
            
            // Validate inputs
            if (isNaN(width) || isNaN(depth) || isNaN(axialLoad) || 
                isNaN(momentX) || isNaN(momentY)) {
                document.getElementById('status').textContent = "Please enter valid numbers";
                return;
            }
            
            // Calculate column design
            designAsPerISCode(width, depth, axialLoad, momentX, momentY, fck, fy, isDuctile);
        }
        
        function designAsPerISCode(width, depth, Pu, Mux, Muy, fck, fy, isDuctile) {
            // Convert units
            Pu = Pu * 1000; // kN to N
            Mux = Mux * 1e6; // kN·m to N·mm
            Muy = Muy * 1e6; // kN·m to N·mm
            
            // Column dimensions
            const b = Math.min(width, depth);
            const D = Math.max(width, depth);
            const Ag = b * D;
            
            // Material properties
            const γm_conc = 1.5; // Partial safety factor for concrete
            const γm_steel = 1.15; // Partial safety factor for steel
            const fcd = 0.67 * fck / γm_conc;
            const fyd = fy / γm_steel;
            
            // Calculate minimum and maximum steel (IS 456 Clause 26.5.3)
            const minSteel = 0.008 * Ag; // 0.8%
            const maxSteel = 0.04 * Ag; // 4%
            
            // Start with minimum steel
            let Ast = minSteel;
            let interactionRatio = Infinity;
            let requiredAst = minSteel;
            let status = "Design FAILS - Increase section";
            
            // Iterate to find required steel (simplified approach)
            for (let p = 0.008; p <= 0.04; p += 0.001) {
                Ast = p * Ag;
                
                // Calculate Puz (Clause 39.6, IS 456:2000)
                const Puz = (0.45 * fck * (Ag - Ast)) + (0.75 * fy * Ast);
                
                // Calculate αn (Clause 39.6)
                const ratio = Pu / Puz;
                const αn = ratio <= 0.2 ? 1.0 : 0.2 + (ratio <= 0.8 ? ratio : 0.8);
                
                // Calculate moment capacities (simplified)
                const d_prime = COVER + 10; // Cover + half of tie diameter
                const d = D - d_prime;
                
                // Simplified Mux1 calculation
                const Mux1 = 0.36 * fck * b * d * d * (1 - (0.42 * (0.48 * d) / d)) + 
                             0.87 * fy * Ast * 0.5 * (d - d_prime);
                
                // For rectangular column, Muy1 might differ but we'll keep same for simplicity
                const Muy1 = Mux1;
                
                // Check interaction equation (Clause 39.6)
                interactionRatio = Math.pow(Mux/Mux1, αn) + Math.pow(Muy/Muy1, αn);
                
                if (interactionRatio <= 1.0) {
                    requiredAst = Ast;
                    status = "Design is SAFE";
                    break;
                }
            }
            
            // Determine bar configuration as per IS 13920 for ductile detailing
            let barDia = MIN_BAR_DIA;
            let numBars = MIN_BARS;
            
            // Find optimal bar diameter and number
            for (let dia = MIN_BAR_DIA; dia <= MAX_BAR_DIA; dia += 2) {
                const barArea = Math.PI * dia * dia / 4;
                numBars = Math.max(MIN_BARS, Math.ceil(requiredAst / barArea));
                
                // Check spacing requirements
                const clearSpacing = (b - (2 * COVER) - (numBars * dia)) / (numBars - 1);
                
                // IS 13920 requirements for special ductile columns
                if (isDuctile) {
                    if (clearSpacing >= Math.max(75, dia * 1.5)) {
                        barDia = dia;
                        break;
                    }
                } else {
                    if (clearSpacing >= Math.max(50, dia)) {
                        barDia = dia;
                        break;
                    }
                }
            }
            
            // Calculate actual provided steel area
            const actualAst = numBars * Math.PI * barDia * barDia / 4;
            
            // Tie details as per IS 13920
            let tieDia, tieSpacing;
            if (isDuctile) {
                tieDia = Math.max(8, barDia/4); // IS 13920 Clause 7.4.6
                tieSpacing = Math.min(
                    b/4, // Least lateral dimension/4
                    6 * barDia, // 6 times smallest longitudinal bar diameter
                    150 // 150mm
                );
            } else {
                tieDia = Math.max(6, barDia/4); // IS 456 Clause 26.5.3.2
                tieSpacing = Math.min(
                    b, // Least lateral dimension
                    16 * barDia, // 16 times smallest longitudinal bar diameter
                    300 // 300mm
                );
            }
            
            // Round tie spacing to nearest 25mm for practicality
            tieSpacing = Math.max(75, Math.round(tieSpacing / 25) * 25);
            
            // Update results
            document.getElementById('status').textContent = status;
            document.getElementById('steelArea').textContent = 
                `${requiredAst.toFixed(0)} mm² (min ${minSteel.toFixed(0)} mm², provided ${actualAst.toFixed(0)} mm²)`;
            document.getElementById('reinforcement').textContent = 
                `${numBars} bars of ${barDia} mm diameter`;
            document.getElementById('tieDetails').textContent = 
                `${tieDia} mm ${isDuctile ? 'ductile' : ''} ties @ ${tieSpacing} mm c/c`;
            document.getElementById('interactionRatio').textContent = 
                interactionRatio.toFixed(3) + (interactionRatio > 1.0 ? " (Overstressed)" : "");
            
            // Update visualization with proper detailing
            updateVisualization(width, depth, numBars, barDia, tieDia, tieSpacing, isDuctile);
        }
        
        function updateVisualization(width, depth, numBars, barDia, tieDia, tieSpacing, isDuctile) {
            const diagram = document.getElementById('columnDiagram');
            diagram.style.width = `${width}px`;
            diagram.style.height = `${depth}px`;
            
            // Clear existing elements
            diagram.innerHTML = '';
            
            // Add cover indication
            const cover = document.createElement('div');
            cover.className = 'cover';
            cover.style.width = `${width - 2*COVER}px`;
            cover.style.height = `${depth - 2*COVER}px`;
            cover.style.left = `${COVER}px`;
            cover.style.top = `${COVER}px`;
            diagram.appendChild(cover);
            
            // Calculate bar positions (as per IS 13920 for ductile detailing)
            const effectiveWidth = width - 2 * COVER;
            const effectiveDepth = depth - 2 * COVER;
            
            // For simplicity, we'll distribute bars evenly along perimeter
            const barsPerSide = Math.max(2, Math.ceil(numBars / 4));
            const xSpacing = effectiveWidth / (barsPerSide - 1);
            const ySpacing = effectiveDepth / (barsPerSide - 1);
            
            // Place bars along all four sides
            const barPositions = [];
            
            // Top side
            for (let i = 0; i < barsPerSide; i++) {
                barPositions.push({
                    x: COVER + i * xSpacing,
                    y: COVER
                });
            }
            
            // Right side
            for (let i = 1; i < barsPerSide - 1; i++) {
                barPositions.push({
                    x: COVER + effectiveWidth,
                    y: COVER + i * ySpacing
                });
            }
            
            // Bottom side
            for (let i = 0; i < barsPerSide; i++) {
                barPositions.push({
                    x: COVER + i * xSpacing,
                    y: COVER + effectiveDepth
                });
            }
            
            // Left side
            for (let i = 1; i < barsPerSide - 1; i++) {
                barPositions.push({
                    x: COVER,
                    y: COVER + i * ySpacing
                });
            }
            
            // Limit to actual number of bars needed
            const finalBarPositions = barPositions.slice(0, numBars);
            
            // Add reinforcement bars
            finalBarPositions.forEach(pos => {
                const bar = document.createElement('div');
                bar.className = 'reinforcement';
                bar.style.width = `${barDia}px`;
                bar.style.height = `${barDia}px`;
                bar.style.left = `${pos.x}px`;
                bar.style.top = `${pos.y}px`;
                diagram.appendChild(bar);
            });
            
            // Add ties (multiple ties for visualization)
            const tieCount = 3; // Show multiple ties for better visualization
            const tieVerticalSpacing = depth / (tieCount + 1);
            
            for (let i = 1; i <= tieCount; i++) {
                const tie = document.createElement('div');
                tie.className = 'ties';
                tie.style.width = `${width - 2*COVER}px`;
                tie.style.height = `${depth - 2*COVER}px`;
                tie.style.left = `${COVER}px`;
                tie.style.top = `${COVER + (i-1)*tieVerticalSpacing}px`;
                tie.style.borderWidth = isDuctile ? '3px' : '2px';
                diagram.appendChild(tie);
            }
            
            // Add dimensions
            addDimension(diagram, 0, 0, width, 0, `${width}mm`, 'top');
            addDimension(diagram, 0, 0, 0, depth, `${depth}mm`, 'left');
            addDimension(diagram, COVER, COVER, width-COVER, COVER, `Cover ${COVER}mm`, 'bottom');
        }
        
        function addDimension(container, x1, y1, x2, y2, text, position) {
            const dimension = document.createElement('div');
            dimension.style.position = 'absolute';
            dimension.style.borderTop = '1px solid #999';
            dimension.style.height = '0';
            dimension.style.width = `${Math.sqrt(Math.pow(x2-x1, 2) + Math.pow(y2-y1, 2))}px`;
            dimension.style.transformOrigin = '0 0';
            dimension.style.transform = `rotate(${Math.atan2(y2-y1, x2-x1)}rad)`;
            dimension.style.left = `${x1}px`;
            dimension.style.top = `${y1}px`;
            
            const label = document.createElement('div');
            label.textContent = text;
            label.style.position = 'absolute';
            label.style.fontSize = '12px';
            label.style.color = '#666';
            
            if (position === 'top') {
                label.style.top = '-20px';
                label.style.left = '50%';
                label.style.transform = 'translateX(-50%)';
            } else if (position === 'bottom') {
                label.style.bottom = '-20px';
                label.style.left = '50%';
                label.style.transform = 'translateX(-50%)';
            } else if (position === 'left') {
                label.style.left = '-60px';
                label.style.top = '50%';
                label.style.transform = 'translateY(-50%) rotate(-90deg)';
            }
            
            dimension.appendChild(label);
            container.appendChild(dimension);
        }
    </script>
</body>
</html>
