<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Column Design Calculator (IS Code)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f5f7fa;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: var(--primary);
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 10px;
        }
        
        .design-section {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .input-section, .output-section {
            flex: 1;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary);
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
        }
        
        .results {
            background-color: var(--light);
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .result-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ccc;
        }
        
        .result-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .result-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .result-value {
            font-size: 18px;
            color: var(--accent);
            font-weight: 700;
        }
        
        .visualization-container {
            margin-top: 30px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        
        .visualization {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .visualization-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .column-diagram {
            border: 1px solid #999;
            background-color: #fff;
            position: relative;
        }
        
        .reinforcement {
            position: absolute;
            border-radius: 50%;
            background-color: var(--accent);
            transform: translate(-50%, -50%);
            border: 1px solid #fff;
        }
        
        .link {
            position: absolute;
            border: 1px solid var(--secondary);
            border-radius: 50%;
        }
        
        .cover {
            position: absolute;
            border: 1px dashed #999;
        }
        
        .dimension {
            position: absolute;
            height: 0;
            border-top: 1px solid #666;
        }
        
        .dimension-label {
            position: absolute;
            font-size: 10px;
            color: #666;
            background: white;
            padding: 0 3px;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 10px 20px;
            background-color: var(--secondary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn-pdf {
            background-color: var(--accent);
        }
        
        .btn-pdf:hover {
            background-color: #c0392b;
        }
        
        @media (max-width: 768px) {
            .design-section {
                flex-direction: column;
            }
        }
        
        /* Print-specific styles */
        @media print {
            body {
                background: none;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                padding: 0;
                max-width: 100%;
            }
            
            .input-section, .action-buttons {
                display: none;
            }
            
            .output-section {
                width: 100%;
            }
            
            .visualization-container {
                page-break-inside: avoid;
            }
        }
        
        /* PDF template styles */
        .pdf-template {
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        
        .pdf-header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }
        
        .pdf-title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        
        .pdf-subtitle {
            font-size: 16px;
            color: #666;
        }
        
        .pdf-section {
            margin-bottom: 20px;
            page-break-inside: avoid;
        }
        
        .pdf-section-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-bottom: 10px;
        }
        
        .pdf-result-item {
            margin-bottom: 10px;
        }
        
        .pdf-result-title {
            font-weight: bold;
        }
        
        .pdf-visualization {
            text-align: center;
            margin: 15px 0;
        }
        
        .pdf-footer {
            text-align: center;
            font-size: 12px;
            color: #666;
            margin-top: 30px;
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Column Design Calculator (IS 456 & IS 13920)</h1>
        
        <div class="design-section">
            <div class="input-section">
                <div class="input-group">
                    <label for="width">Column Width (mm)</label>
                    <input type="number" id="width" value="300" min="300" step="25">
                </div>
                
                <div class="input-group">
                    <label for="depth">Column Depth (mm)</label>
                    <input type="number" id="depth" value="300" min="300" step="25">
                </div>
                
                <div class="input-group">
                    <label for="axialLoad">Axial Load (kN)</label>
                    <input type="number" id="axialLoad" value="850" min="100" step="50">
                </div>
                
                <div class="input-group">
                    <label for="momentX">Moment about X-axis (kN·m)</label>
                    <input type="number" id="momentX" value="15" min="0" step="5">
                </div>
                
                <div class="input-group">
                    <label for="momentY">Moment about Y-axis (kN·m)</label>
                    <input type="number" id="momentY" value="32" min="0" step="5">
                </div>
                
                <div class="input-group">
                    <label for="concreteGrade">Concrete Grade</label>
                    <select id="concreteGrade">
                        <option value="20">M20</option>
                        <option value="25" selected>M25</option>
                        <option value="30">M30</option>
                        <option value="35">M35</option>
                        <option value="40">M40</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="steelGrade">Steel Grade</label>
                    <select id="steelGrade">
                        <option value="415">Fe 415</option>
                        <option value="500" selected>Fe 500</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="ductility">Ductility Requirement</label>
                    <select id="ductility">
                        <option value="normal">Normal (IS 456)</option>
                        <option value="special" selected>Special (IS 13920)</option>
                    </select>
                </div>
            </div>
            
            <div class="output-section">
                <h3>Design Results</h3>
                <div class="results" id="results">
                    <div class="result-item">
                        <div class="result-title">Status</div>
                        <div class="result-value" id="status">Enter values to calculate</div>
                    </div>
                    <div class="result-item">
                        <div class="result-title">Required Steel Area</div>
                        <div class="result-value" id="steelArea">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-title">Reinforcement Details</div>
                        <div class="result-value" id="reinforcement">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-title">Tie Details</div>
                        <div class="result-value" id="tieDetails">-</div>
                    </div>
                    <div class="result-item">
                        <div class="result-title">Interaction Ratio</div>
                        <div class="result-value" id="interactionRatio">-</div>
                    </div>
                </div>
                
                <div class="visualization-container">
                    <div class="visualization">
                        <div class="visualization-title">Plan View (1:20 scale)</div>
                        <div id="planView" class="column-diagram" style="width: 200px; height: 200px;"></div>
                    </div>
                    
                    <div class="visualization">
                        <div class="visualization-title">Elevation View (1:20 scale)</div>
                        <div id="elevationView" class="column-diagram" style="width: 200px; height: 300px;"></div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn" onclick="window.print()">Print Design</button>
                    <button class="btn btn-pdf" id="exportPdf">Export to PDF</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants as per IS Codes
        const COVER = 40; // mm as per IS 456 for columns
        const MIN_BAR_DIA = 12; // mm minimum bar diameter
        const MAX_BAR_DIA = 32; // mm maximum bar diameter
        const MIN_BARS = 4; // Minimum number of bars as per IS 456
        
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;
        
        // Get all input elements
        const inputs = document.querySelectorAll('input, select');
        
        // Add event listeners to all inputs for real-time calculation
        inputs.forEach(input => {
            input.addEventListener('input', calculateDesign);
        });
        
        // Add click event for PDF export
        document.getElementById('exportPdf').addEventListener('click', exportToPDF);
        
        // Initial calculation
        calculateDesign();
        
        function calculateDesign() {
            // Get input values
            const width = parseFloat(document.getElementById('width').value);
            const depth = parseFloat(document.getElementById('depth').value);
            const axialLoad = parseFloat(document.getElementById('axialLoad').value);
            const momentX = parseFloat(document.getElementById('momentX').value);
            const momentY = parseFloat(document.getElementById('momentY').value);
            const fck = parseFloat(document.getElementById('concreteGrade').value);
            const fy = parseFloat(document.getElementById('steelGrade').value);
            const isDuctile = document.getElementById('ductility').value === 'special';
            
            // Validate inputs
            if (isNaN(width) || isNaN(depth) || isNaN(axialLoad) || 
                isNaN(momentX) || isNaN(momentY)) {
                document.getElementById('status').textContent = "Please enter valid numbers";
                return;
            }
            
            // Calculate column design
            const designResults = designAsPerISCode(width, depth, axialLoad, momentX, momentY, fck, fy, isDuctile);
            
            // Update visualizations
            updatePlanView(width, depth, designResults.numBars, designResults.barDia, designResults.isDuctile);
            updateElevationView(width, depth, designResults.numBars, designResults.barDia, 
                              designResults.tieDia, designResults.tieSpacing, designResults.isDuctile);
        }
        
        function designAsPerISCode(width, depth, Pu, Mux, Muy, fck, fy, isDuctile) {
            // Convert units
            Pu = Pu * 1000; // kN to N
            Mux = Mux * 1e6; // kN·m to N·mm
            Muy = Muy * 1e6; // kN·m to N·mm
            
            // Column dimensions
            const b = Math.min(width, depth);
            const D = Math.max(width, depth);
            const Ag = b * D;
            
            // Material properties
            const γm_conc = 1.5; // Partial safety factor for concrete
            const γm_steel = 1.15; // Partial safety factor for steel
            const fcd = 0.67 * fck / γm_conc;
            const fyd = fy / γm_steel;
            
            // Calculate minimum and maximum steel (IS 456 Clause 26.5.3)
            const minSteel = 0.008 * Ag; // 0.8%
            const maxSteel = 0.04 * Ag; // 4%
            
            // Start with minimum steel
            let Ast = minSteel;
            let interactionRatio = Infinity;
            let requiredAst = minSteel;
            let status = "Design FAILS - Increase section";
            
            // Iterate to find required steel (simplified approach)
            for (let p = 0.008; p <= 0.04; p += 0.001) {
                Ast = p * Ag;
                
                // Calculate Puz (Clause 39.6, IS 456:2000)
                const Puz = (0.45 * fck * (Ag - Ast)) + (0.75 * fy * Ast);
                
                // Calculate αn (Clause 39.6)
                const ratio = Pu / Puz;
                const αn = ratio <= 0.2 ? 1.0 : 0.2 + (ratio <= 0.8 ? ratio : 0.8);
                
                // Calculate moment capacities (simplified)
                const d_prime = COVER + 10; // Cover + half of tie diameter
                const d = D - d_prime;
                
                // Simplified Mux1 calculation
                const Mux1 = 0.36 * fck * b * d * d * (1 - (0.42 * (0.48 * d) / d)) + 
                             0.87 * fy * Ast * 0.5 * (d - d_prime);
                
                // For rectangular column, Muy1 might differ but we'll keep same for simplicity
                const Muy1 = Mux1;
                
                // Check interaction equation (Clause 39.6)
                interactionRatio = Math.pow(Mux/Mux1, αn) + Math.pow(Muy/Muy1, αn);
                
                if (interactionRatio <= 1.0) {
                    requiredAst = Ast;
                    status = "Design is SAFE";
                    break;
                }
            }
            
            // Determine bar configuration as per IS 13920 for ductile detailing
            let barDia = MIN_BAR_DIA;
            let numBars = MIN_BARS;
            
            // Find optimal bar diameter and number
            for (let dia = MIN_BAR_DIA; dia <= MAX_BAR_DIA; dia += 2) {
                const barArea = Math.PI * dia * dia / 4;
                numBars = Math.max(MIN_BARS, Math.ceil(requiredAst / barArea));
                
                // Check spacing requirements
                const clearSpacing = (b - (2 * COVER) - (numBars * dia)) / (numBars - 1);
                
                // IS 13920 requirements for special ductile columns
                if (isDuctile) {
                    if (clearSpacing >= Math.max(75, dia * 1.5)) {
                        barDia = dia;
                        break;
                    }
                } else {
                    if (clearSpacing >= Math.max(50, dia)) {
                        barDia = dia;
                        break;
                    }
                }
            }
            
            // Calculate actual provided steel area
            const actualAst = numBars * Math.PI * barDia * barDia / 4;
            
            // Tie details as per IS 13920
            let tieDia, tieSpacing;
            if (isDuctile) {
                tieDia = Math.max(8, barDia/4); // IS 13920 Clause 7.4.6
                tieSpacing = Math.min(
                    b/4, // Least lateral dimension/4
                    6 * barDia, // 6 times smallest longitudinal bar diameter
                    150 // 150mm
                );
            } else {
                tieDia = Math.max(6, barDia/4); // IS 456 Clause 26.5.3.2
                tieSpacing = Math.min(
                    b, // Least lateral dimension
                    16 * barDia, // 16 times smallest longitudinal bar diameter
                    300 // 300mm
                );
            }
            
            // Round tie spacing to nearest 25mm for practicality
            tieSpacing = Math.max(75, Math.round(tieSpacing / 25) * 25);
            
            // Update results
            document.getElementById('status').textContent = status;
            document.getElementById('steelArea').textContent = 
                `${requiredAst.toFixed(0)} mm² (min ${minSteel.toFixed(0)} mm², provided ${actualAst.toFixed(0)} mm²)`;
            document.getElementById('reinforcement').textContent = 
                `${numBars} bars of ${barDia} mm diameter`;
            document.getElementById('tieDetails').textContent = 
                `${tieDia} mm ${isDuctile ? 'ductile' : ''} ties @ ${tieSpacing} mm c/c`;
            document.getElementById('interactionRatio').textContent = 
                interactionRatio.toFixed(3) + (interactionRatio > 1.0 ? " (Overstressed)" : "");
            
            return {
                width,
                depth,
                numBars,
                barDia,
                tieDia,
                tieSpacing,
                isDuctile,
                requiredAst,
                actualAst,
                interactionRatio,
                status
            };
        }
        
        function updatePlanView(width, depth, numBars, barDia, isDuctile) {
            const diagram = document.getElementById('planView');
            diagram.innerHTML = '';
            
            // Set diagram size (1:20 scale)
            const scale = 1/20;
            const diagramWidth = width * scale;
            const diagramHeight = depth * scale;
            diagram.style.width = `${diagramWidth}px`;
            diagram.style.height = `${diagramHeight}px`;
            
            // Add cover indication
            const cover = document.createElement('div');
            cover.className = 'cover';
            cover.style.width = `${(width - 2*COVER) * scale}px`;
            cover.style.height = `${(depth - 2*COVER) * scale}px`;
            cover.style.left = `${COVER * scale}px`;
            cover.style.top = `${COVER * scale}px`;
            diagram.appendChild(cover);
            
            // Calculate bar positions (equally distributed)
            const effectiveWidth = width - 2 * COVER;
            const effectiveDepth = depth - 2 * COVER;
            
            // For plan view, we'll show bars with links at corners
            const barPositions = calculateBarPositions(width, depth, numBars);
            
            // Add reinforcement bars
            barPositions.forEach(pos => {
                const bar = document.createElement('div');
                bar.className = 'reinforcement';
                bar.style.width = `${barDia * scale}px`;
                bar.style.height = `${barDia * scale}px`;
                bar.style.left = `${pos.x * scale}px`;
                bar.style.top = `${pos.y * scale}px`;
                diagram.appendChild(bar);
            });
            
            // Add links at corners (curved)
            if (numBars >= 4) {
                const cornerRadius = 10 * scale;
                const linkSize = 20 * scale;
                
                // Top-left corner
                addCornerLink(diagram, COVER * scale, COVER * scale, cornerRadius, linkSize, 'top-left');
                // Top-right corner
                addCornerLink(diagram, (width - COVER) * scale, COVER * scale, cornerRadius, linkSize, 'top-right');
                // Bottom-right corner
                addCornerLink(diagram, (width - COVER) * scale, (depth - COVER) * scale, cornerRadius, linkSize, 'bottom-right');
                // Bottom-left corner
                addCornerLink(diagram, COVER * scale, (depth - COVER) * scale, cornerRadius, linkSize, 'bottom-left');
            }
            
            // Add dimensions
            addDimension(diagram, 0, 0, width * scale, 0, `${width}mm`, 'top');
            addDimension(diagram, 0, 0, 0, depth * scale, `${depth}mm`, 'left');
        }
        
        function updateElevationView(width, depth, numBars, barDia, tieDia, tieSpacing, isDuctile) {
            const diagram = document.getElementById('elevationView');
            diagram.innerHTML = '';
            
            // Set diagram size (1:20 scale)
            const scale = 1/20;
            const diagramWidth = width * scale;
            const diagramHeight = 300; // Fixed height for elevation
            diagram.style.width = `${diagramWidth}px`;
            diagram.style.height = `${diagramHeight}px`;
            
            // Add cover indication
            const cover = document.createElement('div');
            cover.className = 'cover';
            cover.style.width = `${(width - 2*COVER) * scale}px`;
            cover.style.height = `${diagramHeight - 2*COVER*scale}px`;
            cover.style.left = `${COVER * scale}px`;
            cover.style.top = `${COVER * scale}px`;
            diagram.appendChild(cover);
            
            // Add bars (vertical lines)
            const barPositions = calculateBarPositions(width, depth, numBars);
            barPositions.forEach(pos => {
                // Only show bars on the near face for elevation
                if (pos.y === COVER || pos.y === depth - COVER) {
                    const bar = document.createElement('div');
                    bar.className = 'reinforcement';
                    bar.style.width = `${barDia * scale}px`;
                    bar.style.height = `${(diagramHeight - 2*COVER*scale)}px`;
                    bar.style.left = `${pos.x * scale - barDia*scale/2}px`;
                    bar.style.top = `${COVER * scale}px`;
                    diagram.appendChild(bar);
                }
            });
            
            // Add ties (horizontal lines)
            const tieCount = Math.floor(diagramHeight / (tieSpacing * scale));
            for (let i = 0; i < tieCount; i++) {
                const tie = document.createElement('div');
                tie.className = 'link';
                tie.style.width = `${(width - 2*COVER) * scale}px`;
                tie.style.height = `${tieDia * scale}px`;
                tie.style.left = `${COVER * scale}px`;
                tie.style.top = `${COVER * scale + i * tieSpacing * scale}px`;
                tie.style.borderWidth = isDuctile ? '2px' : '1px';
                diagram.appendChild(tie);
            }
            
            // Add dimensions
            addDimension(diagram, 0, 0, width * scale, 0, `${width}mm`, 'top');
            addDimension(diagram, 0, 0, 0, diagramHeight, `Column Height`, 'left');
            addDimension(diagram, 0, diagramHeight/2, COVER * scale, diagramHeight/2, `Cover ${COVER}mm`, 'top');
        }
        
        function calculateBarPositions(width, depth, numBars) {
            const effectiveWidth = width - 2 * COVER;
            const effectiveDepth = depth - 2 * COVER;
            
            // For simplicity, we'll distribute bars evenly along perimeter
            const barsPerSide = Math.max(2, Math.ceil(numBars / 4));
            const xSpacing = effectiveWidth / (barsPerSide - 1);
            const ySpacing = effectiveDepth / (barsPerSide - 1);
            
            // Place bars along all four sides
            const barPositions = [];
            
            // Top side
            for (let i = 0; i < barsPerSide; i++) {
                barPositions.push({
                    x: COVER + i * xSpacing,
                    y: COVER
                });
            }
            
            // Right side
            for (let i = 1; i < barsPerSide - 1; i++) {
                barPositions.push({
                    x: COVER + effectiveWidth,
                    y: COVER + i * ySpacing
                });
            }
            
            // Bottom side
            for (let i = 0; i < barsPerSide; i++) {
                barPositions.push({
                    x: COVER + i * xSpacing,
                    y: COVER + effectiveDepth
                });
            }
            
            // Left side
            for (let i = 1; i < barsPerSide - 1; i++) {
                barPositions.push({
                    x: COVER,
                    y: COVER + i * ySpacing
                });
            }
            
            // Limit to actual number of bars needed
            return barPositions.slice(0, numBars);
        }
        
        function addCornerLink(container, x, y, radius, size, position) {
            const link = document.createElement('div');
            link.className = 'link';
            link.style.width = `${size}px`;
            link.style.height = `${size}px`;
            link.style.borderRadius = '50%';
            
            // Position based on corner
            if (position === 'top-left') {
                link.style.left = `${x - size/2}px`;
                link.style.top = `${y - size/2}px`;
                link.style.borderRight = 'none';
                link.style.borderBottom = 'none';
            } else if (position === 'top-right') {
                link.style.left = `${x - size/2}px`;
                link.style.top = `${y - size/2}px`;
                link.style.borderLeft = 'none';
                link.style.borderBottom = 'none';
            } else if (position === 'bottom-right') {
                link.style.left = `${x - size/2}px`;
                link.style.top = `${y - size/2}px`;
                link.style.borderLeft = 'none';
                link.style.borderTop = 'none';
            } else if (position === 'bottom-left') {
                link.style.left = `${x - size/2}px`;
                link.style.top = `${y - size/2}px`;
                link.style.borderRight = 'none';
                link.style.borderTop = 'none';
            }
            
            container.appendChild(link);
        }
        
        function addDimension(container, x1, y1, x2, y2, text, position) {
            const dimension = document.createElement('div');
            dimension.className = 'dimension';
            dimension.style.left = `${x1}px`;
            dimension.style.top = `${y1}px`;
            dimension.style.width = `${Math.sqrt(Math.pow(x2-x1, 2) + Math.pow(y2-y1, 2))}px`;
            dimension.style.transform = `rotate(${Math.atan2(y2-y1, x2-x1)}rad)`;
            
            const label = document.createElement('div');
            label.className = 'dimension-label';
            label.textContent = text;
            
            if (position === 'top') {
                label.style.top = '-15px';
                label.style.left = '50%';
                label.style.transform = 'translateX(-50%)';
            } else if (position === 'left') {
                label.style.left = '-40px';
                label.style.top = '50%';
                label.style.transform = 'translateY(-50%) rotate(-90deg)';
            }
            
            dimension.appendChild(label);
            container.appendChild(dimension);
        }
        
        function exportToPDF() {
            // Create a new PDF document
            const doc = new jsPDF('p', 'mm', 'a4');
            
            // Add header
            doc.setFontSize(16);
            doc.setTextColor(40, 40, 40);
            doc.text('COLUMN DESIGN CALCULATION REPORT', 105, 15, { align: 'center' });
            
            doc.setFontSize(12);
            doc.text('As per IS 456:2000 & IS 13920:2016', 105, 22, { align: 'center' });
            
            // Add date
            const today = new Date();
            doc.setFontSize(10);
            doc.text(`Date: ${today.toLocaleDateString()}`, 15, 15);
            
            // Add project info (sample)
            doc.text('Project: Sample Column Design', 15, 22);
            
            // Add a line separator
            doc.setDrawColor(200, 200, 200);
            doc.line(15, 25, 195, 25);
            
            // Add input parameters section
            doc.setFontSize(14);
            doc.setTextColor(30, 30, 30);
            doc.text('1. Design Input Parameters', 15, 35);
            
            doc.setFontSize(11);
            doc.text(`Column Dimensions: ${document.getElementById('width').value}mm × ${document.getElementById('depth').value}mm`, 20, 42);
            doc.text(`Axial Load: ${document.getElementById('axialLoad').value} kN`, 20, 48);
            doc.text(`Moments: Mx = ${document.getElementById('momentX').value} kN·m, My = ${document.getElementById('momentY').value} kN·m`, 20, 54);
            doc.text(`Materials: M${document.getElementById('concreteGrade').value} concrete, Fe ${document.getElementById('steelGrade').value} steel`, 20, 60);
            doc.text(`Ductility: ${document.getElementById('ductility').value === 'special' ? 'Special (IS 13920)' : 'Normal (IS 456)'}`, 20, 66);
            
            // Add design results section
            doc.setFontSize(14);
            doc.text('2. Design Results', 15, 80);
            
            doc.setFontSize(11);
            doc.text(`Status: ${document.getElementById('status').textContent}`, 20, 87);
            doc.text(`Steel Area: ${document.getElementById('steelArea').textContent}`, 20, 93);
            doc.text(`Reinforcement: ${document.getElementById('reinforcement').textContent}`, 20, 99);
            doc.text(`Tie Details: ${document.getElementById('tieDetails').textContent}`, 20, 105);
            doc.text(`Interaction Ratio: ${document.getElementById('interactionRatio').textContent}`, 20, 111);
            
            // Add visualizations section
            doc.setFontSize(14);
            doc.text('3. Column Details', 15, 125);
            
            // Capture plan view and add to PDF
            html2canvas(document.getElementById('planView')).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                doc.addImage(imgData, 'PNG', 30, 132, 60, 60);
                doc.text('Plan View (1:20 scale)', 60, 195, { align: 'center' });
                
                // Capture elevation view and add to PDF
                html2canvas(document.getElementById('elevationView')).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    doc.addImage(imgData, 'PNG', 110, 132, 60, 90);
                    doc.text('Elevation View (1:20 scale)', 140, 225, { align: 'center' });
                    
                    // Add notes section
                    doc.setFontSize(14);
                    doc.text('4. Design Notes', 15, 235);
                    
                    doc.setFontSize(10);
                    const notes = [
                        '1. All dimensions are in millimeters unless specified otherwise.',
                        '2. Concrete cover is 40mm as per IS 456 for columns.',
                        '3. Reinforcement detailing follows IS 13920 for ductile columns.',
                        '4. Design assumes short column behavior (slenderness ratio < 12).',
                        '5. Actual site conditions may require adjustments to the design.'
                    ];
                    
                    notes.forEach((note, i) => {
                        doc.text(note, 20, 242 + i * 5);
                    });
                    
                    // Add footer
                    doc.setFontSize(8);
                    doc.setTextColor(100, 100, 100);
                    doc.text('Generated by Column Design Calculator', 105, 290, { align: 'center' });
                    
                    // Save the PDF
                    doc.save(`Column_Design_${document.getElementById('width').value}x${document.getElementById('depth').value}_${today.getTime()}.pdf`);
                });
            });
        }
    </script>
</body>
</html>
